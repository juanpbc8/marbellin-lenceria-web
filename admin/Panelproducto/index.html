<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Administrar Productos</title>
 <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #ffe6f0, #fff0f5);
      margin: 0;
      padding: 0;
      color: #333;
    }

    .container {
      max-width: 1000px;
      margin: 40px auto;
      padding: 20px 40px;
      background-color: #ffffffdd;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      border-radius: 20px;
    }

    h1, h2 {
      text-align: center;
      color: #d63384;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }

    th, td {
      padding: 10px;
      text-align: center;
      border-bottom: 1px solid #ddd;
    }

    th {
      background-color: #ffc0cb;
      color: #fff;
      font-weight: bold;
    }

    td img.producto-img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 8px;
      border: 2px solid #ffc0cb;
    }

    form label {
      display: block;
      margin-top: 15px;
      font-weight: 600;
    }

    form input[type="text"],
    form input[type="number"],
    form select,
    form textarea,
    form input[type="file"] {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 10px;
      box-sizing: border-box;
      font-size: 14px;
    }

    form textarea {
      resize: vertical;
      height: 80px;
    }

    button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #d63384;
      color: #fff;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #c2185b;
    }

    #mensajeVacio {
      text-align: center;
      font-style: italic;
      color: #999;
      margin-bottom: 15px;
    }

  
 .filtro-categoria-container {
  width: 100%;
  max-width: 1000px;
  margin: 30px auto;
  padding: 12px 24px;                /* Menor altura y buen espaciado horizontal */
  background-color: #fff0f6;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  box-sizing: border-box;
}

.filtro-categoria-container label {
  font-weight: 600;
  font-size: 1.1rem;
  color: #d6336c;
}

.filtro-categoria-container select {
  width: 260px;                      /* M√°s ancho horizontal */
  padding: 6px 14px;                 /* Menor altura */
  font-size: 1rem;
  border: 2px solid #d6336c;
  border-radius: 10px;
  background-color: #fff;
  color: #333;
  cursor: pointer;
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.filtro-categoria-container select:hover,
.filtro-categoria-container select:focus {
  border-color: #a71d45;
  box-shadow: 0 0 8px rgba(214, 51, 108, 0.5);
  outline: none;
}
 
    @media (max-width: 768px) {
      .container {
        padding: 20px;
      }

      table, thead, tbody, th, td, tr {
        display: block;
      }

      thead tr {
        display: none;
      }

      td {
        position: relative;
        padding-left: 50%;
        text-align: left;
      }

      td::before {
        position: absolute;
        top: 10px;
        left: 10px;
        width: 45%;
        white-space: nowrap;
        font-weight: bold;
      }

      td:nth-child(1)::before { content: "Imagen"; }
      td:nth-child(2)::before { content: "ID"; }
      td:nth-child(3)::before { content: "Nombre"; }
      td:nth-child(4)::before { content: "S"; }
      td:nth-child(5)::before { content: "M"; }
      td:nth-child(6)::before { content: "L"; }
      td:nth-child(7)::before { content: "XL"; }
      td:nth-child(8)::before { content: "Precio"; }
      td:nth-child(9)::before { content: "Acci√≥n"; }
    }
  </style>
</head>
<body>

<div class="container">
  
  <h2>Lista de Productos</h2>

<div class="filtro-categoria-container">
  <label for="filtroCategoria"><strong>Filtrar por categor√≠a:</strong></label>
  <select id="filtroCategoria" onchange="filtrarPorCategoria()">
    <option value="todas">Todas</option>
    <option value="bikini">Bikini</option>
    <option value="cachetero">Cachetero</option>
    <option value="topsitos">Topsitos</option>
    <option value="semi-hilo">Semi Hilo</option>
  </select>
</div>
  
   <p id="mensajeVacio"></p>
  <table>
    <thead>
      <tr>
        <th>Imagen</th>
        <th>ID</th>
        <th>Nombre</th>
        <th>S</th>
        <th>M</th>
        <th>L</th>
        <th>XL</th>
        <th>Precio</th>
        <th>Acci√≥n</th>
      </tr>
    </thead>
    <tbody id="tablaProductos"></tbody>
  </table>

 <h1 id="formTitulo">Agregar Nuevo Producto</h1>

<form id="formAgregarProducto" onsubmit="event.preventDefault(); guardarProducto();">
  <label for="id">ID del Producto:</label>
  <input type="number" id="id" min="1" required>

  <label for="nombre">Nombre:</label>
  <input type="text" id="nombre" maxlength="50" required>

  <label for="precio">Precio (S/):</label>
  <input type="number" id="precio" min="0.01" step="0.01" required>

  <label for="descripcion">Descripci√≥n:</label>
  <textarea id="descripcion" maxlength="300" required></textarea>

  <label for="imagenes">Seleccionar Im√°genes:</label>
  <input type="file" id="imagenes" accept="image/*" multiple>

  <label for="categoria">Categor√≠a:</label>
  <select id="categoria" required>
    <option value="" disabled selected>Selecciona una categor√≠a</option>
    <option value="bikini">Bikini</option>
    <option value="cachetero">Cachetero</option>
    <option value="topsitos">Topsitos</option>
    <option value="semi-hilo">Semi Hilo</option>
  </select>

  <label for="cantidadS">Cantidad Talla S:</label>
  <input type="number" id="cantidadS" min="0" value="0">

  <label for="cantidadM">Cantidad Talla M:</label>
  <input type="number" id="cantidadM" min="0" value="0">

  <label for="cantidadL">Cantidad Talla L:</label>
  <input type="number" id="cantidadL" min="0" value="0">

  <label for="cantidadXL">Cantidad Talla XL:</label>
  <input type="number" id="cantidadXL" min="0" value="0">

  <button type="submit" id="btnGuardar">Agregar Producto</button>
  <button type="button" id="btnLimpiar" onclick="limpiarFormulario()">Limpiar Formulario</button>
</form>
  
  <h1 id="formEditarTitulo" style="display:none;">Editar Producto</h1>

    <!-- Formulario para editar producto -->
    <form id="formEditarProducto" style="display:none;" onsubmit="event.preventDefault(); guardarEdicionProducto();">
      <label for="editId">ID del Producto:</label>
      <input type="number" id="editId" min="1" disabled />

      <label for="editNombre">Nombre:</label>
      <input type="text" id="editNombre" maxlength="50" required />

      <label for="editPrecio">Precio (S/):</label>
      <input type="number" id="editPrecio" min="0.01" step="0.01" required />

      <label for="editDescripcion">Descripci√≥n:</label>
      <textarea id="editDescripcion" maxlength="300" required></textarea>

      <label for="editImagenes">Seleccionar Nuevas Im√°genes (opcional):</label>
      <input type="file" id="editImagenes" accept="image/*" multiple />

      <label for="editCategoria">Categor√≠a:</label>
      <select id="editCategoria" required>
        <option value="" disabled>Selecciona una categor√≠a</option>
        <option value="bikini">Bikini</option>
        <option value="cachetero">Cachetero</option>
        <option value="topsitos">Topsitos</option>
        <option value="semi-hilo">Semi Hilo</option>
      </select>

      <label for="editCantidadS">Cantidad Talla S:</label>
      <input type="number" id="editCantidadS" min="0" value="0" />

      <label for="editCantidadM">Cantidad Talla M:</label>
      <input type="number" id="editCantidadM" min="0" value="0" />

      <label for="editCantidadL">Cantidad Talla L:</label>
      <input type="number" id="editCantidadL" min="0" value="0" />

      <label for="editCantidadXL">Cantidad Talla XL:</label>
      <input type="number" id="editCantidadXL" min="0" value="0" />

      <button type="submit" id="btnGuardarEdicion">Guardar Cambios</button>
      <button type="button" onclick="cancelarEdicion()">Cancelar</button>
    </form>

<script>
  let editandoId = null;

// Guardar producto NUEVO (solo agrega, no edita)
function guardarProducto() {
  const id = parseInt(document.getElementById('id').value);
  let nombre = document.getElementById('nombre').value.trim();
  let precio = parseFloat(document.getElementById('precio').value);
  let descripcion = document.getElementById('descripcion').value.trim();
  const inputImagenes = document.getElementById('imagenes');
  const categoria = document.getElementById('categoria').value;
  const cantidadS = parseInt(document.getElementById('cantidadS').value) || 0;
  const cantidadM = parseInt(document.getElementById('cantidadM').value) || 0;
  const cantidadL = parseInt(document.getElementById('cantidadL').value) || 0;
  const cantidadXL = parseInt(document.getElementById('cantidadXL').value) || 0;

  if (isNaN(id)) return alert("‚ùå El ID debe ser un n√∫mero.");
  if (!nombre) return alert("‚ùå El nombre es obligatorio.");
  if (isNaN(precio) || precio <= 0) return alert("‚ùå El precio debe ser mayor a 0.");
  if (!categoria) return alert("‚ùå Selecciona una categor√≠a.");
  if (cantidadS + cantidadM + cantidadL + cantidadXL <= 0) return alert("‚ùå Debes ingresar al menos una unidad.");

  nombre = nombre.toLowerCase().split(' ').map(p => p.charAt(0).toUpperCase() + p.slice(1)).join(' ');
  descripcion = descripcion.charAt(0).toUpperCase() + descripcion.slice(1).toLowerCase();

  const productos = JSON.parse(localStorage.getItem('productoadmin')) || [];

  if (productos.some(p => p.id === id)) return alert("‚ùå El ID ya est√° en uso.");
  if (productos.some(p => p.nombre.toLowerCase() === nombre.toLowerCase())) return alert("‚ùå El nombre ya existe.");

  const imagenes = [];

  const guardar = () => {
    const nuevoProducto = {
      id,
      nombre,
      precio,
      descripcion,
      imagenes,
      categoria,
      tallas: { S: cantidadS, M: cantidadM, L: cantidadL, XL: cantidadXL }
    };

    productos.push(nuevoProducto);

    localStorage.setItem('productoadmin', JSON.stringify(productos));
    limpiarFormularioAgregar();
    mostrarProductosEnTabla();
    alert('‚úÖ Producto agregado correctamente.');
  };

  if (inputImagenes.files.length > 0) {
    let cargadas = 0;
    Array.from(inputImagenes.files).forEach((file, index) => {
      const reader = new FileReader();
      reader.onload = () => {
        imagenes[index] = reader.result;
        cargadas++;
        if (cargadas === inputImagenes.files.length) guardar();
      };
      reader.readAsDataURL(file);
    });
  } else {
    guardar();
  }
}

// Guardar edici√≥n producto (desde formulario editar)
function guardarEdicionProducto() {
  if (!editandoId) return alert("‚ùå No hay producto seleccionado para editar.");

  let nombre = document.getElementById('editNombre').value.trim();
  let precio = parseFloat(document.getElementById('editPrecio').value);
  let descripcion = document.getElementById('editDescripcion').value.trim();
  const inputImagenes = document.getElementById('editImagenes');
  const categoria = document.getElementById('editCategoria').value;
  const cantidadS = parseInt(document.getElementById('editCantidadS').value) || 0;
  const cantidadM = parseInt(document.getElementById('editCantidadM').value) || 0;
  const cantidadL = parseInt(document.getElementById('editCantidadL').value) || 0;
  const cantidadXL = parseInt(document.getElementById('editCantidadXL').value) || 0;

  if (!nombre) return alert("‚ùå El nombre es obligatorio.");
  if (isNaN(precio) || precio <= 0) return alert("‚ùå El precio debe ser mayor a 0.");
  if (!categoria) return alert("‚ùå Selecciona una categor√≠a.");
  if (cantidadS + cantidadM + cantidadL + cantidadXL <= 0) return alert("‚ùå Debes ingresar al menos una unidad.");

  nombre = nombre.toLowerCase().split(' ').map(p => p.charAt(0).toUpperCase() + p.slice(1)).join(' ');
  descripcion = descripcion.charAt(0).toUpperCase() + descripcion.slice(1).toLowerCase();

  const productos = JSON.parse(localStorage.getItem('productoadmin')) || [];

  // Validar nombre duplicado en otro producto
  const duplicadoNombre = productos.some(p => p.nombre.toLowerCase() === nombre.toLowerCase() && p.id !== editandoId);
  if (duplicadoNombre) return alert("‚ùå Ya existe otro producto con ese nombre.");

  const index = productos.findIndex(p => p.id === editandoId);
  if (index === -1) return alert("‚ùå Producto no encontrado.");

  const imagenes = [];

  const guardar = () => {
    // Mantener im√°genes viejas si no se cargaron nuevas
    productos[index].imagenes = imagenes.length ? imagenes : productos[index].imagenes;

    productos[index].nombre = nombre;
    productos[index].precio = precio;
    productos[index].descripcion = descripcion;
    productos[index].categoria = categoria;
    productos[index].tallas = { S: cantidadS, M: cantidadM, L: cantidadL, XL: cantidadXL };

    localStorage.setItem('productoadmin', JSON.stringify(productos));
    limpiarFormularioEditar();
    mostrarProductosEnTabla();
    alert('‚úÖ Producto actualizado correctamente.');
  };

  if (inputImagenes.files.length > 0) {
    let cargadas = 0;
    Array.from(inputImagenes.files).forEach((file, idx) => {
      const reader = new FileReader();
      reader.onload = () => {
        imagenes[idx] = reader.result;
        cargadas++;
        if (cargadas === inputImagenes.files.length) guardar();
      };
      reader.readAsDataURL(file);
    });
  } else {
    guardar();
  }
}

// Limpiar formulario AGREGAR
function limpiarFormularioAgregar() {
  document.getElementById('formAgregarProducto').reset();
  editandoId = null;
}

// Limpiar formulario EDITAR y ocultarlo
function limpiarFormularioEditar() {
  document.getElementById('formEditarProducto').reset();
  document.getElementById('formEditarProducto').style.display = 'none';
  document.getElementById('formEditarTitulo').style.display = 'none';
  editandoId = null;
  // Mostrar formulario agregar de nuevo si estaba oculto
  document.getElementById('formAgregarProducto').style.display = 'block';
  document.getElementById('formTitulo').style.display = 'block';
  document.getElementById('btnGuardar').disabled = false;
}

// Cancelar edici√≥n (bot√≥n cancelar)
function cancelarEdicion() {
  limpiarFormularioEditar();
}

// Mostrar productos en tabla (igual que antes)
function mostrarProductosEnTabla(categoriaFiltro = null) {
  const productos = JSON.parse(localStorage.getItem('productoadmin')) || [];
  const tabla = document.getElementById('tablaProductos');
  const mensaje = document.getElementById('mensajeVacio');
  tabla.innerHTML = '';

  const productosFiltrados = categoriaFiltro && categoriaFiltro !== 'todas'
    ? productos.filter(p => p.categoria === categoriaFiltro)
    : productos;

  mensaje.textContent = productosFiltrados.length ? '' : 'No hay productos registrados.';

  productosFiltrados.forEach(producto => {
    const fila = document.createElement('tr');

    const imgCell = document.createElement('td');
    const img = document.createElement('img');
    img.src = producto.imagenes[0] || '';
    img.style.width = '80px';
    img.style.height = '80px';
    img.style.objectFit = 'cover';
    imgCell.appendChild(img);
    fila.appendChild(imgCell);

    fila.innerHTML += `
      <td>${producto.id}</td>
      <td>${producto.nombre}</td>
      <td>${producto.tallas.S}</td>
      <td>${producto.tallas.M}</td>
      <td>${producto.tallas.L}</td>
      <td>${producto.tallas.XL}</td>
      <td>S/ ${producto.precio.toFixed(2)}</td>
      <td>
        <button onclick="editarProducto(${producto.id})">‚úèÔ∏è</button>
        <button onclick="eliminarProducto(${producto.id})">üóëÔ∏è</button>
      </td>
    `;
    tabla.appendChild(fila);
  });
}

function filtrarPorCategoria() {
  const seleccion = document.getElementById("filtroCategoria").value;
  mostrarProductosEnTabla(seleccion);
}

// Al hacer clic en editar, mostrar el formulario editar y cargar datos
function editarProducto(id) {
  const productos = JSON.parse(localStorage.getItem('productoadmin')) || [];
  const producto = productos.find(p => p.id === id);
  if (!producto) return;

  editandoId = id;

  // Mostrar formulario editar, ocultar formulario agregar
  document.getElementById('formEditarProducto').style.display = 'block';
  document.getElementById('formEditarTitulo').style.display = 'block';
  document.getElementById('formAgregarProducto').style.display = 'none';
  document.getElementById('formTitulo').style.display = 'none';

  // Cargar datos en formulario editar
  document.getElementById('editId').value = producto.id;
  document.getElementById('editNombre').value = producto.nombre;
  document.getElementById('editPrecio').value = producto.precio;
  document.getElementById('editDescripcion').value = producto.descripcion;
  document.getElementById('editCategoria').value = producto.categoria;
  document.getElementById('editCantidadS').value = producto.tallas.S;
  document.getElementById('editCantidadM').value = producto.tallas.M;
  document.getElementById('editCantidadL').value = producto.tallas.L;
  document.getElementById('editCantidadXL').value = producto.tallas.XL;

  // Limpiar input im√°genes (no se cargan autom√°ticamente)
  document.getElementById('editImagenes').value = '';
}

// Eliminar producto igual que antes
function eliminarProducto(id) {
  if (!confirm('¬øEliminar este producto?')) return;
  const productos = JSON.parse(localStorage.getItem('productoadmin')) || [];
  const nuevos = productos.filter(p => p.id !== id);
  localStorage.setItem('productoadmin', JSON.stringify(nuevos));
  mostrarProductosEnTabla();
}

  function limpiarFormulario() {
    document.getElementById('formAgregarProducto').reset();
    document.getElementById('id').disabled = false;
    editandoId = null;
    document.getElementById("formTitulo").textContent = "Agregar Nuevo Producto";
    document.getElementById("btnGuardar").textContent = "Agregar Producto";
  }
  
// Mostrar productos al cargar la p√°gina
window.onload = () => mostrarProductosEnTabla();
  </script>
  
</body>
</html>
  
  
  
  

